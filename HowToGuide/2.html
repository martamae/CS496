<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">
    <title>MapKit How To Guide</title>
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="css/jumbotron.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">MapKit How To Guide</a>
            </div>
        </div>
    </nav>
    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
        <div class="container">
            <h1>Add Current Location to Map</h1>
        </div>
    </div>
    <div class="container">
        <div class="mid">
                <h2>Expanding the Code</h2>
                <p>The next step is to get the users location. To do this, first, you need to create an instance of the CLLocationManager class and store a reference to it.</p>
                <img src="img/locMan.png">
                <p>Place this code inside the ViewController class.</p>
                <br />
                <p>Then, you need to declare the class as implementing the MKMapViewDelegate protocol, which allows you to use a certain set of map related methods, and the CLLocationManagerDelegate, which allows you to manage the delivery of location related events to the application</p>
                <p>Add <b>MKMapViewDelegate</b> and <b>CLLocationManagerDelegate</b> to the class declaration</p>
                <img src="img/classDeclare.png" />
                <br /><br />
                <p>We then need to indicate that the ViewController class is the delegate for both the mapView object and the locationManager. To do this add this code inside the viewDidLoad() function</p>
                <img src="img/delegate.png" />
                <br /><br />
                <h2>User Location Authorization</h2>
                <p>The next step is to request permission from the user to access information about their current location. Put the following line inside the the viewDidLoad() function:</p>
                <img src="img/request.png">
                <br /><br />
                <p>This line will ask the user to allow access to their location, but first, in order to get the request to appear to ther user, you need to update the <b>Info.plist</b> file. Open the file. Then to add to the apps Information Property List, hover over the <b>Information Property List</b> key and a + sign will appear. Click the + sign and a new line will be added to the Information Property List. Set the Key to <b>Privacy - Location When In Use Usage Description</b>, the Type to <b>String</b>, and the Value to the message you want to display to the user when the request is made </p>
                <br />
                <img src="img/infoplist.png" height="250" width="650">
                <br /><br /><br />
                <p>Now you can run the app and the request to access the user's location should pop up</p>
                <img src="img/requestPopup.png" width="255" height="470">
                <br /><br />
                <h2>Adding the Current Location</h2>
                <p>Now that you have requested permission from the user to access their location you can display that location on the map</p>
                <p>Return to the Main.storyboard/ViewController.swift view to add to the code</p>
                <p>To display the current location add the folllowing code inside the viewDidLoad() function under the delegate expressions:</p>
                <img src="img/curLoc.png" />
                <br /><br />
                <p>Explanation of this code:</p>
                <p><b>if CLLocationManager.locationServicesEnabled()</b> - anything inside this block will only be executed if the user allows the application to access their current location</p>
                <p><b>mapView.showUserLocation = true</b> - shows the users current location on the map view</p>
                <br />
                <p>Now run the app and the users current location will be marked.</p>
                <img src="img/mapLocation.png" width="255" height="470">
                <br /><br /><br />
                <div class="nav-btns">
                    <div class="back-btn">
                        <p><a class="btn btn-default" href="1.html" role="button">&laquo; Create App and Add Map </a></p>
                    </div> <!--back-btn-->
                    <div class="next-btn">
                        <p><a class="btn btn-default" href="3.html" role="button">Getting Route &raquo;</a></p>
                    </div> <!--next-btn-->
                </div> <!--nav-btns-->
        </div><!---/mid-->
    </div> <!-- /container -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../../dist/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
</body>
</html>